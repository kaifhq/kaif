var s="frag",x=(l,a,...f)=>typeof l=="function"?l({...a,children:f}):{...a,elem:l,children:f};var E=(l,a)=>{let f={$el:l,elem:l.nodeName.toLowerCase()},i,m=()=>{i=y(f,a(),l),r(f),f=i},r=n=>{(n.children??[]).map(r),n.repaint||(n=n.$el.remove())},y=(n,e,g)=>{Array.isArray(e)&&(e={children:e,elem:s}),(typeof e=="string"||typeof e=="number")&&(e={innerText:e.toString()}),e.elem=e.elem||"span",!n||(i=n.elem!==e.elem)?(n&&i&&r(n),e.elem==s?e.$el=g:(e.$el=document.createElement(e.elem),g.append(e.$el))):(n.repaint=!0,e.$el=n.$el,e.cleanup=n.cleanup);let{$el:o,elem:c,children:h,cleanup:b,...d}=e;if(b)for(let t in b)o.removeEventListener(t.substring(2),e.cleanup[t]);e.cleanup={};for(let t in d)typeof(i=d[t])>"u"||(t.indexOf("on")!=0?typeof i=="object"?Object.assign(o[t],i):o[t]=i:o.addEventListener(t.substring(2),e.cleanup[t]=p=>{let $=d[t](p);$&&typeof $.then=="function"||m()}));return h?{...e,children:h.map((t,p)=>y(n&&n.children&&n.children[p],t,o))}:e};return m(),m},k={init:E,h:x,Fragment:s};export{k as default};
